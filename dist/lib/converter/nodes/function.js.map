{"version":3,"file":"function.js","sourceRoot":"","sources":["../../../../src/lib/converter/nodes/function.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA,+BAAiC;AAEjC,4CAAgF;AAChF,4CAAwE;AAExE,0CAAyC;AACzC,4CAAkE;AAGlE;IAAuC,qCAAmE;IAD1G;QAAA,qEA6CC;QAxCG,cAAQ,GAAoB;YACxB,EAAE,CAAC,UAAU,CAAC,eAAe;YAC7B,EAAE,CAAC,UAAU,CAAC,iBAAiB;YAC/B,EAAE,CAAC,UAAU,CAAC,mBAAmB;SACpC,CAAC;;IAoCN,CAAC;IA3BG,mCAAO,GAAP,UAAQ,OAAgB,EAAE,IAAiD;QACvE,IAAM,KAAK,GAAK,OAAO,CAAC,KAAK,CAAC;QAC9B,IAAM,IAAI,GAAM,KAAK,CAAC,IAAI,GAAG,sBAAc,CAAC,gBAAgB,CAAC,CAAC,CAAC,sBAAc,CAAC,MAAM,CAAC,CAAC,CAAC,sBAAc,CAAC,QAAQ,CAAC;QAC/G,IAAM,OAAO,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;QAC5B,IAAM,MAAM,GAAI,yBAAiB,CAAC,OAAO,EAAY,IAAI,EAAE,IAAI,CAAC,CAAC;QAEjE,EAAE,CAAC,CAAC,MAAM;eACH,IAAI,GAAG,sBAAc,CAAC,MAAM;eAC5B,IAAI,CAAC,SAAS;eACd,IAAI,CAAC,SAAS,CAAC,IAAI,CAAE,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,IAAI,KAAK,EAAE,CAAC,UAAU,CAAC,eAAe,EAAxC,CAAwC,CAAE,CAAC,CAAC,CAAC;YAC5E,MAAM,CAAC,OAAO,CAAC,sBAAc,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;QAChD,CAAC;QAED,OAAO,CAAC,SAAS,CAAC,MAAM,EAAE;YACtB,EAAE,CAAC,CAAC,CAAC,OAAO,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC;gBACjC,IAAM,SAAS,GAAG,uBAAe,CAAC,OAAO,EAA4B,IAAI,EAAE,MAAM,CAAC,IAAI,EAAE,sBAAc,CAAC,aAAa,CAAC,CAAC;gBACtH,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC;oBACrB,MAAM,CAAC,UAAU,GAAG,EAAE,CAAC;gBAC3B,CAAC;gBACD,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YACtC,CAAC;YAAC,IAAI,CAAC,CAAC;gBACJ,OAAO,CAAC,OAAO,CAAC,qBAAS,CAAC,6BAA6B,EAAE,MAAM,EAAY,IAAI,CAAC,CAAC;YACrF,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,MAAM,CAAC,MAAM,CAAC;IAClB,CAAC;IA3CQ,iBAAiB;QAD7B,sBAAS,CAAC,EAAC,IAAI,EAAE,eAAe,EAAC,CAAC;OACtB,iBAAiB,CA4C7B;IAAD,wBAAC;CAAA,AA5CD,CAAuC,mCAAsB,GA4C5D;AA5CY,8CAAiB","sourcesContent":["import * as ts from 'typescript';\r\n\r\nimport { Reflection, ReflectionFlag, ReflectionKind } from '../../models/index';\r\nimport { createDeclaration, createSignature } from '../factories/index';\r\nimport { Context } from '../context';\r\nimport { Converter } from '../converter';\r\nimport { Component, ConverterNodeComponent } from '../components';\r\n\r\n@Component({name: 'node:function'})\r\nexport class FunctionConverter extends ConverterNodeComponent<ts.FunctionDeclaration|ts.MethodDeclaration> {\r\n    /**\r\n     * List of supported TypeScript syntax kinds.\r\n     */\r\n    supports: ts.SyntaxKind[] = [\r\n        ts.SyntaxKind.MethodSignature,\r\n        ts.SyntaxKind.MethodDeclaration,\r\n        ts.SyntaxKind.FunctionDeclaration\r\n    ];\r\n\r\n    /**\r\n     * Analyze the given function declaration node and create a suitable reflection.\r\n     *\r\n     * @param context  The context object describing the current state the converter is in.\r\n     * @param node     The function declaration node that should be analyzed.\r\n     * @return The resulting reflection or NULL.\r\n     */\r\n    convert(context: Context, node: ts.FunctionDeclaration|ts.MethodDeclaration): Reflection {\r\n        const scope   = context.scope;\r\n        const kind    = scope.kind & ReflectionKind.ClassOrInterface ? ReflectionKind.Method : ReflectionKind.Function;\r\n        const hasBody = !!node.body;\r\n        const method  = createDeclaration(context, <ts.Node> node, kind);\r\n\r\n        if (method  // child inheriting will return null on createDeclaration\r\n            && kind & ReflectionKind.Method\r\n            && node.modifiers\r\n            && node.modifiers.some( m => m.kind === ts.SyntaxKind.AbstractKeyword )) {\r\n          method.setFlag(ReflectionFlag.Abstract, true);\r\n        }\r\n\r\n        context.withScope(method, () => {\r\n            if (!hasBody || !method.signatures) {\r\n                const signature = createSignature(context, <ts.SignatureDeclaration> node, method.name, ReflectionKind.CallSignature);\r\n                if (!method.signatures) {\r\n                    method.signatures = [];\r\n                }\r\n                method.signatures.push(signature);\r\n            } else {\r\n                context.trigger(Converter.EVENT_FUNCTION_IMPLEMENTATION, method, <ts.Node> node);\r\n            }\r\n        });\r\n\r\n        return method;\r\n    }\r\n}\r\n"]}