{"version":3,"file":"AssetsPlugin.js","sourceRoot":"","sources":["../../../../src/lib/output/plugins/AssetsPlugin.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA,2BAA6B;AAC7B,6BAA+B;AAE/B,4CAA6D;AAC7D,oCAA0C;AAC1C,wCAAuC;AAOvC;IAAkC,gCAAiB;IADnD;QAAA,qEAoCC;QA/BG,uBAAiB,GAAG,IAAI,CAAC;;IA+B7B,CAAC;IA1BG,iCAAU,GAAV;QACI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK;YACpB,GAAC,sBAAa,CAAC,KAAK,IAAG,IAAI,CAAC,eAAe;gBAC7C,CAAC;;IACP,CAAC;IAOO,sCAAe,GAAvB,UAAwB,KAAoB;QACxC,IAAI,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,mBAAQ,CAAC,eAAe,EAAE,EAAE,QAAQ,CAAC,CAAC;QAClE,IAAM,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,eAAe,EAAE,QAAQ,CAAC,CAAC;QAEtD,EAAE,CAAC,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC;YACzB,EAAE,CAAC,QAAQ,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;QACjC,CAAC;QAAC,IAAI,CAAC,CAAC;YACJ,WAAW,GAAG,IAAI,CAAC;QACvB,CAAC;QAED,IAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;QAC5D,EAAE,CAAC,CAAC,IAAI,KAAK,WAAW,IAAI,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YAC9C,EAAE,CAAC,QAAQ,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;QAC1B,CAAC;IACL,CAAC;IAlCQ,YAAY;QADxB,sBAAS,CAAC,EAAC,IAAI,EAAE,QAAQ,EAAC,CAAC;OACf,YAAY,CAmCxB;IAAD,mBAAC;CAAA,AAnCD,CAAkC,8BAAiB,GAmClD;AAnCY,oCAAY","sourcesContent":["import * as Path from 'path';\r\nimport * as FS from 'fs-extra';\r\n\r\nimport { Component, RendererComponent } from '../components';\r\nimport { RendererEvent } from '../events';\r\nimport { Renderer } from '../renderer';\r\n\r\n/**\r\n * A plugin that copies the subdirectory ´assets´ from the current themes\r\n * source folder to the output directory.\r\n */\r\n@Component({name: 'assets'})\r\nexport class AssetsPlugin extends RendererComponent {\r\n    /**\r\n     * Should the default assets always be copied to the output directory?\r\n     */\r\n    copyDefaultAssets = true;\r\n\r\n    /**\r\n     * Create a new AssetsPlugin instance.\r\n     */\r\n    initialize() {\r\n        this.listenTo(this.owner, {\r\n            [RendererEvent.BEGIN]: this.onRendererBegin\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Triggered before the renderer starts rendering a project.\r\n     *\r\n     * @param event  An event object describing the current render operation.\r\n     */\r\n    private onRendererBegin(event: RendererEvent) {\r\n        let fromDefault = Path.join(Renderer.getDefaultTheme(), 'assets');\r\n        const to = Path.join(event.outputDirectory, 'assets');\r\n\r\n        if (this.copyDefaultAssets) {\r\n            FS.copySync(fromDefault, to);\r\n        } else {\r\n            fromDefault = null;\r\n        }\r\n\r\n        const from = Path.join(this.owner.theme.basePath, 'assets');\r\n        if (from !== fromDefault && FS.existsSync(from)) {\r\n            FS.copySync(from, to);\r\n        }\r\n    }\r\n}\r\n"]}