{"version":3,"file":"component.js","sourceRoot":"","sources":["../../../../../src/lib/utils/options/sources/component.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA,6CAAmG;AACnG,sCAA8C;AAG9C;IAAqC,mCAAgB;IAArD;;IA0CA,CAAC;IAvCa,oCAAU,GAApB;QACI,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;QAC1B,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAEpC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW;YAC1B,GAAC,0BAAc,CAAC,KAAK,IAAK,IAAI,CAAC,gBAAgB;YAC/C,GAAC,0BAAc,CAAC,OAAO,IAAG,IAAI,CAAC,kBAAkB;gBACnD,CAAC;;IACP,CAAC;IAEO,sCAAY,GAApB,UAAqB,SAAiC;QAClD,IAAM,IAAI,GAAG,SAAS,CAAC,aAAa,CAAC;QACrC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;YACR,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,+BAA+B,CAAC,CAAC;YAC/D,MAAM,CAAC;QACX,CAAC;QAED,EAAE,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;YAC5C,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAChC,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,SAAS,CAAC,qBAAqB,EAAE,CAAC,CAAC;QAClE,CAAC;QAED,EAAE,CAAC,CAAC,SAAS,YAAY,8BAAkB,CAAC,CAAC,CAAC;YAC1C,GAAG,CAAC,CAAc,UAAyB,EAAzB,KAAA,SAAS,CAAC,aAAa,EAAE,EAAzB,cAAyB,EAAzB,IAAyB;gBAAtC,IAAI,KAAK,SAAA;gBACV,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;aAC5B;QACL,CAAC;IACL,CAAC;IAEO,0CAAgB,GAAxB,UAAyB,CAAiB;QACtC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;IACnC,CAAC;IAEO,4CAAkB,GAA1B,UAA2B,CAAiB;QACxC,IAAM,YAAY,GAAG,CAAC,CAAC,SAAS,CAAC,qBAAqB,EAAE,CAAC;QACzD,GAAG,CAAC,CAAoB,UAAY,EAAZ,6BAAY,EAAZ,0BAAY,EAAZ,IAAY;YAA/B,IAAI,WAAW,qBAAA;YAChB,IAAI,CAAC,KAAK,CAAC,uBAAuB,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;SACxD;IACL,CAAC;IAzCQ,eAAe;QAD3B,qBAAS,CAAC,EAAC,IAAI,EAAE,mBAAmB,EAAC,CAAC;OAC1B,eAAe,CA0C3B;IAAD,sBAAC;CAAA,AA1CD,CAAqC,0BAAgB,GA0CpD;AA1CY,0CAAe","sourcesContent":["import { Component, ComponentEvent, AbstractComponent, ChildableComponent } from '../../component';\r\nimport { OptionsComponent } from '../options';\r\n\r\n@Component({name: 'options:component'})\r\nexport class ComponentSource extends OptionsComponent {\r\n    private knownComponents: string[];\r\n\r\n    protected initialize() {\r\n        this.knownComponents = [];\r\n        this.addComponent(this.application);\r\n\r\n        this.listenTo(this.application, {\r\n            [ComponentEvent.ADDED]:   this.onComponentAdded,\r\n            [ComponentEvent.REMOVED]: this.onComponentRemoved\r\n        });\r\n    }\r\n\r\n    private addComponent(component: AbstractComponent<any>) {\r\n        const name = component.componentName;\r\n        if (!name) {\r\n            this.application.logger.error('Component without name found.');\r\n            return;\r\n        }\r\n\r\n        if (this.knownComponents.indexOf(name) === -1) {\r\n            this.knownComponents.push(name);\r\n            this.owner.addDeclarations(component.getOptionDeclarations());\r\n        }\r\n\r\n        if (component instanceof ChildableComponent) {\r\n            for (let child of component.getComponents()) {\r\n                this.addComponent(child);\r\n            }\r\n        }\r\n    }\r\n\r\n    private onComponentAdded(e: ComponentEvent) {\r\n        this.addComponent(e.component);\r\n    }\r\n\r\n    private onComponentRemoved(e: ComponentEvent) {\r\n        const declarations = e.component.getOptionDeclarations();\r\n        for (let declaration of declarations) {\r\n            this.owner.removeDeclarationByName(declaration.name);\r\n        }\r\n    }\r\n}\r\n"]}